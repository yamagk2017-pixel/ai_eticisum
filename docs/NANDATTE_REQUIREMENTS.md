# ナンダッテ（NANDATTE）機能要件まとめ（ドラフト）

## 1. 目的・コンセプト
- アイドル（グループ）の「…ってみんなに思われてるよ」を、投票データから可視化する。
- IMDB（既存の約600組のグループDB）と連携し、全グループに個別ページを自動生成する。
- 将来的には IHC（イマキテランキング）／バズッタラ／musicite記事と統合サイトへ発展させる。

---

## 2. 対象データ（入力）
### 2.1 投票項目（指標）
- 事前定義の「あるある指標」を用意（例：楽曲、ルックス、ダンス、歌唱力 等）。
- 追加で「フリーワード（自由入力）」を許可。
- ユーザーは投票時に以下を閲覧できる：
  - そのグループの現在の上位指標（Top5）
  - あるある指標一覧
  - 既存フリーワード（候補）

### 2.2 投票の集計方針
- 表示の中心は「得票数ベース」。
- グループページで見せるチャート要素は **得票上位5位**。
- Top5の合計票が **全投票に対して何％か（Top5シェア）** を表示し、集中型／多面型のニュアンスを伝える。

---

## 3. グループページ（個別ページ）
### 3.1 表示要素
- グループ基本情報（IMDBから取得）
- **魅力Top5（得票数）**
  - 棒グラフ（順位・票数を明確に）
  - 1位〜5位のラベル＋票数
- **Top5合計票／Top5シェア（全体比％）**
- **総投票数**
- 可能なら短い自動文（例：「このグループは“楽曲”が特に語られています」等）

### 3.2 グループ内・全体ランキング
- グループページに「総合ランキング順位（投票数ランキング）」を表示。
- 可能なら変動情報（例：前日比／過去7日比）を表示。

---

## 4. トップページ／ランキング機能
### 4.1 トップページ上位表示（投票のあるグループを優先）
- 「最近投票されたグループ」を上位表示（最新の動きを見せる）。
- 投票が入るほど露出が増える設計で、投票を促進。

### 4.2 投票数ランキング
- 「投票数ランキング（≒人気ランキング）」を提供。
- 表記は誤解防止のため「投票数ランキング」として明示。

---

## 5. 投票フロー（UX）
### 5.1 基本仕様
- **1ユーザーは1グループにつき投票は1回まで**（原則）。
  - 目的：重複投稿の抑制／データの信頼性確保。

### 5.2 登録ハードルを下げる導線（推奨）
- 入口でいきなり登録を要求しない。
- **投票→仮反映→ログイン（確定）** の二段階方式を採用（推奨）。
  - 投票ボタン押下で「未確定の1票」を作る
  - 「この1票を反映するにはログイン」モーダルを表示
  - OAuth（X / Google / Apple）またはメール（マジックリンク）で確定

### 5.3 投票促進ナッジ（実装候補）
- 「あと3票で1位になります」
- 「2位と3位の差：わずか4票」
- 「あなたの1票で順位が変わるかも」
- 未投票ユーザー向けメッセージ：
  - 「最初の10票は特に影響が大きい」
  - 「推しポイントを1つ選ぶだけでOK」

### 5.4 投票後のフィードバック
- 投票後に棒グラフが伸びる／順位が切り替わる等のアニメーション。
- 「あなたの1票が反映されました」を明示。

---

## 6. SNS連動（拡散導線）
- 投票後に **シェア画像（OG画像／カード）を自動生成**。
  - 例：『〇〇の魅力TOP5』『私は“世界観”に投票しました』
- Xで拡散しやすい文面・画像フォーマットを用意。

---

## 7. ユーザー機能（任意／拡張）
### 7.1 投票履歴（プロフィール化）
- ユーザーが「どのグループに／どの指標に投票したか」を保存。
- 可視化することで「増やしたくなる」動機を作る。

### 7.2 無料投票・課金（検討）
- ベースは登録ユーザー。
- 「1日1回無料投票」＋課金で追加投票、などの選択肢。
  - ただし「1グループ1回」ルールとの整合性は要設計（例：追加投票＝別グループのみ／応援投票枠など）。

---

## 8. musicite／IHC／バズッタラ連動（段階的）
### 8.1 musicite記事連動
- 記事末尾に「このグループの魅力に投票する」ボタン。
- ライブレポ／インタビュー閲覧後に自然に投票へ誘導。

### 8.2 IHC連動
- IHCのグループページからナンダッテへ導線。
- 統合サイト化後は同一グループページ内で連携表示が理想。

### 8.3 バズッタラ連動
- 将来的に「SNSで話題」「投票が増えた」などの相関を見せられる余地。

---

## 9. 重要な思想（UI文言に落とす）
- 投票＝貢献／推し活／文脈形成。
- 例文（UI内に配置する候補）：
  - 「このデータが、グループの魅力の可視化につながります」
  - 「まだ票が少ないので、あなたの1票が特に大きいです」
  - 「あなたの投票が、このグループの“みんなの見方”をつくります」

---

## 10. 未確定・要検討（ToDo）
- フリーワードの扱い：
  - 同義語統合（表記ゆれ）／荒らし対策（NGワード）／候補化のルール
- 「1グループ1回」厳密性の担保：
  - OAuth必須の範囲、匿名時の仮反映、重複防止の仕組み
- ランキング更新周期：
  - リアルタイム／バッチ／日次・週次の見せ分け
- 投票の編集可否：
  - 1回投票を「後から変更できる」仕様にするか（不正や荒れやすさとトレードオフ）

## Backlog / Future ideas
- しおり機能（NANDATTE以外のページを保存）
- user_bookmarks テーブル設計（user_id, page_type, page_id, title, url, created_at）
- トレンドウォッチ（管理者がトレンドワード登録 → 関連コンテンツをDBから集約してリンク表示）
